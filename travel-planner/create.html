<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Create Spot</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body style="padding:20px">
  <h2>Create Spot</h2>
  <p style="color:#9aa4b2">You must be logged in.</p>
  <form id="form">
    <input id="name" placeholder="Name" required style="padding:8px;width:340px"><br><br>
    <input id="city" placeholder="City" style="padding:8px;width:340px"><br><br>
    <input id="image" placeholder="Image URL" style="padding:8px;width:340px"><br><br>
    <input id="cost" placeholder="Cost" style="padding:8px;width:340px"><br><br>
    <input id="people" placeholder="People" style="padding:8px;width:340px"><br><br>
    <input id="points" placeholder="Points" style="padding:8px;width:340px"><br><br>
    <input id="startDate" placeholder="Start Date (text)" style="padding:8px;width:340px"><br><br>
    <input id="endDate" placeholder="End Date (text)" style="padding:8px;width:340px"><br><br>
    <input id="transport" placeholder="Transport" style="padding:8px;width:340px"><br><br>
    <button class="ghost-btn">Add</button>
  </form>
  <p><a class="ghost-btn" href="index.html">Back to swipe</a></p>

  <script src="firebase.js"></script>
  <script>
    let me=null;
    firebase.auth().onAuthStateChanged(u=>{
      me=u;
      if(!u){ alert('Please login first.'); location.href='login.html'; }
    });
    const form=document.getElementById('form');
    form.addEventListener('submit', async e=>{
      e.preventDefault();
      if(!me){ alert('Login required.'); return; }
      const doc={
        name:document.getElementById('name').value.trim(),
        city:document.getElementById('city').value.trim(),
        image:document.getElementById('image').value.trim(),
        cost:document.getElementById('cost').value.trim(),
        people:document.getElementById('people').value.trim(),
        points:document.getElementById('points').value.trim(),
        startDate:document.getElementById('startDate').value.trim(),
        endDate:document.getElementById('endDate').value.trim(),
        transport:document.getElementById('transport').value.trim(),
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      };
      try{
        await firebase.firestore().collection('spots').add(doc);
        alert('Spot added.'); location.href='index.html';
      }catch(err){ alert(err.message); }
    });
  </script>
</body>
</html>
